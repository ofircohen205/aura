apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Namespace is set in overlays, not in base
# Namespaces are created per environment in overlays
resources:
  - backend/configmap.yaml
  - backend/secret.yaml
  - backend/deployment.yaml
  - backend/service.yaml
  - web-dashboard/configmap.yaml
  - web-dashboard/deployment.yaml
  - web-dashboard/service.yaml
  - postgres/pvc.yaml
  - postgres/secret.yaml
  - postgres/statefulset.yaml
  - postgres/service.yaml
  - migrations/job.yaml
  # Note: migration-scripts ConfigMap is created by create-migration-configmap.sh script
  # It's not included in base to avoid conflicts
  # Network policies - can be disabled in dev overlay if too restrictive
  - network-policies/default-deny.yaml
  - network-policies/backend-policy.yaml
  - network-policies/web-policy.yaml
  - network-policies/postgres-policy.yaml
  # RBAC - Service accounts and permissions
  - rbac/service-accounts.yaml
  - rbac/roles.yaml
  - rbac/role-bindings.yaml

labels:
  - pairs:
      managed-by: kustomize
      project: aura
