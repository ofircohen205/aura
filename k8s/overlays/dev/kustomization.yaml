apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: aura-dev

resources:
  - namespace.yaml
  - ../../base

# Development-specific patches
# Use strategic merge to properly merge arrays (like env vars)
patchesStrategicMerge:
  - backend-patch.yaml
  - web-patch.yaml
  - postgres-patch.yaml
  - disable-network-policies.yaml

# Development-specific configurations
configMapGenerator:
  - name: backend-config
    behavior: merge
    literals:
      - ENVIRONMENT=local
      - LOG_LEVEL=DEBUG
      - LOG_FORMAT=text
  - name: web-dashboard-config
    behavior: merge
    literals:
      - NODE_ENV=development
      - NEXT_PUBLIC_API_URL=http://localhost:8000

secretGenerator:
  - name: backend-secrets
    behavior: merge
    literals:
      - postgres-db-uri=postgresql+psycopg://aura:aura@postgres:5432/aura_db
  - name: postgres-secrets
    behavior: merge
    literals:
      - postgres-user=aura
      - postgres-password=aura
      - postgres-db=aura_db

images:
  - name: aura-backend
    newName: aura-backend
    newTag: dev
  - name: aura-web-dashboard
    newName: aura-web-dashboard
    newTag: dev
